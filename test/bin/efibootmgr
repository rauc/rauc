#!/usr/bin/env python3

import argparse
import sys


def main():
    parser = argparse.ArgumentParser(description='efibootmgr mock for RAUC testing')

    parser.add_argument("--bootorder", metavar="ORDER", help="Set boot order")
    parser.add_argument("--bootnext", metavar="NEXT", help="Set next boot entry")

    if len(sys.argv) == 1:
        print("BootCurrent: 0002")
        print("Timeout: 0 seconds")
        print("BootOrder: 0001,0002,0003,0000")
        print("Boot0000* invalid")
        print("Boot0001* system0")
        print("Boot0002* system1")
        print("Boot0003  recovery")
        sys.exit(0)

    args = parser.parse_args()

    if args.bootorder is not None:
        # Test code must move system1 to primary position. Assert this!
        print(f"--bootorder: {args.bootorder}")
        # if args.bootorder != "0002,0001,0003,0000":
        #     sys.exit(1)
    elif args.bootnext is not None:
        # Test code must move system1 to primary position. Assert this!
        print(f"--bootnext: {args.bootnext}")
        if args.bootnext != "0002":
            sys.exit(1)
    else:
        print(f"Invalid key: '{sys.argv[1]}'")
        sys.exit(1)


if __name__ == "__main__":
    main()
